"use strict";(self.webpackChunkair_monitoring_frontend=self.webpackChunkair_monitoring_frontend||[]).push([[200,956],{2828:(e,t,s)=>{s.d(t,{A:()=>v});var a=s(58168),r=s(98587),n=s(65043),c=s(58387),i=s(98610),l=s(98206),o=s(34535),d=s(92532),A=s(72372);function h(e){return(0,A.Ay)("MuiCardActionArea",e)}const u=(0,d.A)("MuiCardActionArea",["root","focusVisible","focusHighlight"]);var x=s(72949),p=s(70579);const m=["children","className","focusVisibleClassName"],j=(0,o.Ay)(x.A,{name:"MuiCardActionArea",slot:"Root",overridesResolver:(e,t)=>t.root})((e=>{let{theme:t}=e;return{display:"block",textAlign:"inherit",borderRadius:"inherit",width:"100%",["&:hover .".concat(u.focusHighlight)]:{opacity:(t.vars||t).palette.action.hoverOpacity,"@media (hover: none)":{opacity:0}},["&.".concat(u.focusVisible," .").concat(u.focusHighlight)]:{opacity:(t.vars||t).palette.action.focusOpacity}}})),g=(0,o.Ay)("span",{name:"MuiCardActionArea",slot:"FocusHighlight",overridesResolver:(e,t)=>t.focusHighlight})((e=>{let{theme:t}=e;return{overflow:"hidden",pointerEvents:"none",position:"absolute",top:0,right:0,bottom:0,left:0,borderRadius:"inherit",opacity:0,backgroundColor:"currentcolor",transition:t.transitions.create("opacity",{duration:t.transitions.duration.short})}})),v=n.forwardRef((function(e,t){const s=(0,l.b)({props:e,name:"MuiCardActionArea"}),{children:n,className:o,focusVisibleClassName:d}=s,A=(0,r.A)(s,m),u=s,x=(e=>{const{classes:t}=e;return(0,i.A)({root:["root"],focusHighlight:["focusHighlight"]},h,t)})(u);return(0,p.jsxs)(j,(0,a.A)({className:(0,c.A)(x.root,o),focusVisibleClassName:(0,c.A)(d,x.focusVisible),ref:t,ownerState:u},A,{children:[n,(0,p.jsx)(g,{className:x.focusHighlight,ownerState:u})]}))}))},3632:(e,t,s)=>{s.d(t,{A:()=>n});var a=s(59662),r=s(70579);const n=(0,a.A)((0,r.jsx)("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5M12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5m0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"}),"Visibility")},26072:(e,t,s)=>{var a=s(24994);t.A=void 0;var r=a(s(40039)),n=s(70579);t.A=(0,r.default)((0,n.jsx)("path",{d:"M20 3H4c-1.1 0-2 .9-2 2v11c0 1.1.9 2 2 2h3l-1 1v2h12v-2l-1-1h3c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m0 13H4V5h16z"}),"Monitor")},28994:(e,t,s)=>{var a=s(24994);t.A=void 0;var r=a(s(40039)),n=s(70579);t.A=(0,r.default)((0,n.jsx)("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2M9 17H7v-7h2zm4 0h-2V7h2zm4 0h-2v-4h2z"}),"Assessment")},45360:(e,t,s)=>{s.d(t,{A:()=>c});var a=s(89379),r=s(82431);const n="/asbestos-clearances",c={getAll:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(await r.A.get(n,{params:e})).data},getById:async e=>(await r.A.get("".concat(n,"/").concat(e))).data,create:async e=>(await r.A.post(n,e)).data,update:async(e,t)=>(await r.A.put("".concat(n,"/").concat(e),t)).data,delete:async e=>(await r.A.delete("".concat(n,"/").concat(e))).data,updateStatus:async(e,t)=>(await r.A.patch("".concat(n,"/").concat(e,"/status"),{status:t})).data,getStats:async()=>(await r.A.get("".concat(n,"/stats/overview"))).data,search:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s=(0,a.A)({search:e},t);return(await r.A.get(n,{params:s})).data},getByStatus:async e=>(await r.A.get(n,{params:{status:e}})).data,getByRemovalist:async e=>(await r.A.get(n,{params:{asbestosRemovalist:e}})).data}},47200:(e,t,s)=>{s.r(t),s.d(t,{default:()=>g});var a=s(89379),r=s(65043),n=s(12110),c=s(2828),i=s(26494),l=s(96446),o=s(85865),d=s(68903),A=s(73216),h=s(26072),u=s(28994),x=s(39284),p=s(60956),m=s(70579);const j=e=>{let{title:t,icon:s,onClick:a,color:d="primary"}=e;return(0,m.jsx)(n.A,{sx:{height:"100%",display:"flex",flexDirection:"column",transition:"transform 0.2s, box-shadow 0.2s","&:hover":{transform:"translateY(-4px)",boxShadow:4}},children:(0,m.jsx)(c.A,{onClick:a,sx:{height:"100%",display:"flex",flexDirection:"column",alignItems:"stretch"},children:(0,m.jsxs)(i.A,{sx:{flexGrow:1,textAlign:"center",p:3},children:[(0,m.jsx)(l.A,{sx:{mb:2,display:"flex",justifyContent:"center"},children:r.cloneElement(s,{sx:{fontSize:48,color:"".concat(d,".main")}})}),(0,m.jsx)(o.A,{variant:"h6",component:"h2",gutterBottom:!0,children:t})]})})})},g=()=>{(0,A.Zp)(),(0,A.zy)();const[e,t]=(0,r.useState)(null),s=[{title:"Air Monitoring",icon:(0,m.jsx)(h.A,{}),color:"primary",onClick:()=>t("air-monitoring")},{title:"Clearances",icon:(0,m.jsx)(u.A,{}),color:"secondary",onClick:()=>t("clearances")}];return(0,m.jsxs)(l.A,{sx:{p:3},children:[(0,m.jsx)(o.A,{variant:"h4",component:"h1",gutterBottom:!0,sx:{mb:4},children:"Asbestos Removal"}),(0,m.jsx)(d.Ay,{container:!0,spacing:3,children:s.map(((e,t)=>(0,m.jsx)(d.Ay,{item:!0,xs:12,md:6,children:(0,m.jsx)(j,(0,a.A)({},e))},t)))}),e&&(0,m.jsx)(l.A,{sx:{mt:4},children:(()=>{switch(e){case"air-monitoring":return(0,m.jsx)(x.A,{});case"clearances":return(0,m.jsx)(p.default,{});default:return null}})()})]})}},60956:(e,t,s)=>{s.r(t),s.d(t,{default:()=>U});var a=s(89379),r=s(65043),n=s(96446),c=s(81637),i=s(67254),l=s(85865),o=s(11906),d=s(12110),A=s(26494),h=s(79650),u=s(63336),x=s(71806),p=s(84882),m=s(28076),j=s(10039),g=s(73460),v=s(43845),y=s(17392),f=s(90035),b=s(26600),C=s(35316),w=s(68903),D=s(53193),H=s(79190),S=s(72221),I=s(32143),R=s(15795),k=s(29347),z=s(73158),V=s(70141),P=s(3632),M=s(83560),N=s(59662),L=s(70579);const _=(0,N.A)((0,L.jsx)("path",{d:"M20 2H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2m-8.5 7.5c0 .83-.67 1.5-1.5 1.5H9v2H7.5V7H10c.83 0 1.5.67 1.5 1.5zm5 2c0 .83-.67 1.5-1.5 1.5h-2.5V7H15c.83 0 1.5.67 1.5 1.5zm4-3H19v1h1.5V11H19v2h-1.5V7h3zM9 9.5h1v-1H9zM4 6H2v14c0 1.1.9 2 2 2h14v-2H4zm10 5.5h1v-3h-1z"}),"PictureAsPdf");var F=s(51387),T=s(73216),W=s(63777),E=s(88027),B=s(45360),q=s(76961),O=s(43381);const U=()=>{const e=W.LU,t=(0,T.Zp)(),[s,N]=(0,r.useState)([]),[U,G]=(0,r.useState)([]),[Z,Y]=(0,r.useState)(!0),[J,K]=(0,r.useState)(null),[Q,X]=(0,r.useState)(!1),[$,ee]=(0,r.useState)(null),[te,se]=(0,r.useState)(!1),[ae,re]=(0,r.useState)({open:!1,message:"",severity:"success"}),[ne,ce]=(0,r.useState)({projectId:"",clearanceDate:"",clearanceType:"Non-friable",LAA:"",asbestosRemovalist:"",notes:""});(0,r.useEffect)((()=>{ie()}),[]);const ie=async()=>{try{Y(!0);const[e,t]=await Promise.all([B.A.getAll(),q.A.getAll({limit:1e3,status:"Assigned,In progress,Samples submitted,Lab Analysis Complete,Report sent for review,Ready for invoicing,Invoice sent"})]);console.log("Clearances API response:",e),console.log("Projects API response:",t),N(e.clearances||e.data||e||[]),G(t.data||t)}catch(e){console.error("Error fetching data:",e),K("Failed to load data")}finally{Y(!1)}},le=()=>{ce({projectId:"",clearanceDate:"",clearanceType:"Non-friable",LAA:"",asbestosRemovalist:"",notes:""})},oe=e=>{switch(e){case"complete":return"success";case"in progress":return"warning";case"Site Work Complete":return"info";default:return"default"}},de=e=>{const t=U.find((t=>t._id===e));return t?t.name:"Unknown Project"};return Z?(0,L.jsx)(n.A,{display:"flex",justifyContent:"center",alignItems:"center",height:"400px",children:(0,L.jsx)(c.A,{})}):J?(0,L.jsx)(n.A,{m:"20px",children:(0,L.jsx)(i.A,{severity:"error",children:J})}):(0,L.jsx)(E.A,{requiredPermissions:["asbestos.view"],children:(0,L.jsxs)(n.A,{m:"20px",children:[(0,L.jsxs)(n.A,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[(0,L.jsx)(l.A,{variant:"h2",color:e.grey[100],fontWeight:"bold",sx:{mb:"5px"},children:"Asbestos Clearance"}),(0,L.jsx)(o.A,{variant:"contained",color:"secondary",onClick:()=>{ee(null),le(),X(!0)},startIcon:(0,L.jsx)(V.A,{}),children:"Add Clearance"})]}),(0,L.jsx)(d.A,{sx:{mt:3},children:(0,L.jsx)(A.A,{children:(0,L.jsx)(h.A,{component:u.A,children:(0,L.jsxs)(x.A,{children:[(0,L.jsx)(p.A,{children:(0,L.jsxs)(m.A,{children:[(0,L.jsx)(j.A,{children:"Project"}),(0,L.jsx)(j.A,{children:"Clearance Date"}),(0,L.jsx)(j.A,{children:"Type"}),(0,L.jsx)(j.A,{children:"LAA"}),(0,L.jsx)(j.A,{children:"Removalist"}),(0,L.jsx)(j.A,{children:"Status"}),(0,L.jsx)(j.A,{children:"Actions"})]})}),(0,L.jsx)(g.A,{children:(s||[]).map((e=>(0,L.jsxs)(m.A,{children:[(0,L.jsx)(j.A,{children:de(e.projectId)}),(0,L.jsx)(j.A,{children:e.clearanceDate?new Date(e.clearanceDate).toLocaleDateString():"N/A"}),(0,L.jsx)(j.A,{children:e.clearanceType}),(0,L.jsx)(j.A,{children:e.LAA}),(0,L.jsx)(j.A,{children:e.asbestosRemovalist}),(0,L.jsx)(j.A,{children:(0,L.jsx)(v.A,{label:e.status,color:oe(e.status),size:"small"})}),(0,L.jsxs)(j.A,{children:[(0,L.jsx)(y.A,{onClick:()=>(e=>{t("/clearances/".concat(e._id,"/items"))})(e),color:"info",size:"small",title:"View Items",children:(0,L.jsx)(P.A,{})}),(0,L.jsx)(y.A,{onClick:()=>(e=>{ee(e),ce({projectId:e.projectId._id||e.projectId,clearanceDate:e.clearanceDate?new Date(e.clearanceDate).toISOString().split("T")[0]:"",clearanceType:e.clearanceType,LAA:e.LAA,asbestosRemovalist:e.asbestosRemovalist,notes:e.notes||""}),X(!0)})(e),color:"primary",size:"small",title:"Edit",children:(0,L.jsx)(M.A,{})}),(0,L.jsx)(y.A,{onClick:()=>(async e=>{try{se(!0);const t=await B.A.getById(e._id),s=await(0,O.Hj)("asbestos-clearance",t);re({open:!0,message:"PDF generated successfully: ".concat(s),severity:"success"})}catch(t){console.error("Error generating PDF:",t),re({open:!0,message:"Failed to generate PDF",severity:"error"})}finally{se(!1)}})(e),color:"secondary",size:"small",disabled:te,title:"Generate PDF",children:(0,L.jsx)(_,{})}),(0,L.jsx)(y.A,{onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this clearance?"))try{await B.A.delete(e._id),re({open:!0,message:"Clearance deleted successfully",severity:"success"}),ie()}catch(t){console.error("Error deleting clearance:",t),re({open:!0,message:"Failed to delete clearance",severity:"error"})}})(e),color:"error",size:"small",title:"Delete",children:(0,L.jsx)(F.A,{})})]})]},e._id)))})]})})})}),(0,L.jsxs)(f.A,{open:Q,onClose:()=>X(!1),maxWidth:"md",fullWidth:!0,children:[(0,L.jsx)(b.A,{children:$?"Edit Clearance":"Add New Clearance"}),(0,L.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{$?(await B.A.update($._id,ne),re({open:!0,message:"Clearance updated successfully",severity:"success"})):(await B.A.create(ne),re({open:!0,message:"Clearance created successfully",severity:"success"})),X(!1),ee(null),le(),ie()}catch(t){console.error("Error saving clearance:",t),re({open:!0,message:"Failed to save clearance",severity:"error"})}},children:[(0,L.jsx)(C.A,{children:(0,L.jsxs)(w.Ay,{container:!0,spacing:2,children:[(0,L.jsx)(w.Ay,{item:!0,xs:12,children:(0,L.jsxs)(D.A,{fullWidth:!0,required:!0,children:[(0,L.jsx)(H.A,{children:"Project"}),(0,L.jsx)(S.A,{value:ne.projectId,onChange:e=>ce((0,a.A)((0,a.A)({},ne),{},{projectId:e.target.value})),label:"Project",children:(U||[]).map((e=>(0,L.jsxs)(I.A,{value:e._id,children:[e.projectID,": ",e.name]},e._id)))})]})}),(0,L.jsx)(w.Ay,{item:!0,xs:12,md:6,children:(0,L.jsx)(R.A,{fullWidth:!0,type:"date",label:"Clearance Date",value:ne.clearanceDate,onChange:e=>ce((0,a.A)((0,a.A)({},ne),{},{clearanceDate:e.target.value})),required:!0,InputLabelProps:{shrink:!0}})}),(0,L.jsx)(w.Ay,{item:!0,xs:12,md:6,children:(0,L.jsxs)(D.A,{fullWidth:!0,required:!0,children:[(0,L.jsx)(H.A,{children:"Clearance Type"}),(0,L.jsxs)(S.A,{value:ne.clearanceType,onChange:e=>ce((0,a.A)((0,a.A)({},ne),{},{clearanceType:e.target.value})),label:"Clearance Type",children:[(0,L.jsx)(I.A,{value:"Non-friable",children:"Non-friable"}),(0,L.jsx)(I.A,{value:"Friable",children:"Friable"})]})]})}),(0,L.jsx)(w.Ay,{item:!0,xs:12,md:6,children:(0,L.jsx)(R.A,{fullWidth:!0,label:"LAA",value:ne.LAA,onChange:e=>ce((0,a.A)((0,a.A)({},ne),{},{LAA:e.target.value})),required:!0})}),(0,L.jsx)(w.Ay,{item:!0,xs:12,md:6,children:(0,L.jsx)(R.A,{fullWidth:!0,label:"Asbestos Removalist",value:ne.asbestosRemovalist,onChange:e=>ce((0,a.A)((0,a.A)({},ne),{},{asbestosRemovalist:e.target.value})),required:!0})}),(0,L.jsx)(w.Ay,{item:!0,xs:12,children:(0,L.jsx)(R.A,{fullWidth:!0,label:"Notes",value:ne.notes,onChange:e=>ce((0,a.A)((0,a.A)({},ne),{},{notes:e.target.value})),multiline:!0,rows:3})})]})}),(0,L.jsxs)(k.A,{children:[(0,L.jsx)(o.A,{onClick:()=>X(!1),children:"Cancel"}),(0,L.jsx)(o.A,{type:"submit",variant:"contained",children:$?"Update":"Create"})]})]})]}),(0,L.jsx)(z.A,{open:ae.open,autoHideDuration:6e3,onClose:()=>re((0,a.A)((0,a.A)({},ae),{},{open:!1})),children:(0,L.jsx)(i.A,{onClose:()=>re((0,a.A)((0,a.A)({},ae),{},{open:!1})),severity:ae.severity,children:ae.message})})]})})}},76961:(e,t,s)=>{s.d(t,{A:()=>r});var a=s(82431);const r={getAll:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(await a.A.get("/projects",{params:e})).data},getById:e=>a.A.get("/projects/".concat(e)),create:e=>a.A.post("/projects",e),update:(e,t)=>a.A.put("/projects/".concat(e),t),delete:e=>a.A.delete("/projects/".concat(e))}}}]);
//# sourceMappingURL=200.4d7093b5.chunk.js.map