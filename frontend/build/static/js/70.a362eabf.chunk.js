"use strict";(self.webpackChunkair_monitoring_frontend=self.webpackChunkair_monitoring_frontend||[]).push([[70],{19882:(e,t,a)=>{a.d(t,{A:()=>r});var s=a(94505);const n={getAllTemplates:async()=>{try{const[e,t]=await Promise.all([s.Ay.get("/asbestos-clearance-templates"),s.Ay.get("/lead-assessment-templates")]);return[...e.data,...t.data]}catch(e){throw console.error("Error fetching report templates:",e),e}},getTemplateByType:async e=>{try{let t;if("asbestosClearanceNonFriable"===e||"asbestosClearanceFriable"===e)t=await s.Ay.get("/asbestos-clearance-templates/".concat(e));else{if("leadAssessment"!==e)throw new Error("Unknown template type: ".concat(e));t=await s.Ay.get("/lead-assessment-templates/".concat(e))}return t.data}catch(t){throw console.error("Error fetching report template:",t),t}},createTemplate:async e=>{try{const{templateType:t}=e;let a;if("asbestosClearanceNonFriable"===t||"asbestosClearanceFriable"===t)a=await s.Ay.post("/asbestos-clearance-templates",e);else{if("leadAssessment"!==t)throw new Error("Unknown template type: ".concat(t));a=await s.Ay.post("/lead-assessment-templates",e)}return a.data}catch(t){throw console.error("Error creating report template:",t),t}},updateTemplate:async(e,t)=>{try{let a;if("asbestosClearanceNonFriable"===e||"asbestosClearanceFriable"===e)a=await s.Ay.put("/asbestos-clearance-templates/".concat(e),t);else{if("leadAssessment"!==e)throw new Error("Unknown template type: ".concat(e));a=await s.Ay.put("/lead-assessment-templates/".concat(e),t)}return a.data}catch(a){throw console.error("Error updating report template:",a),a}},deleteTemplate:async e=>{try{let t;if("asbestosClearanceNonFriable"===e||"asbestosClearanceFriable"===e)t=await s.Ay.delete("/asbestos-clearance-templates/".concat(e));else{if("leadAssessment"!==e)throw new Error("Unknown template type: ".concat(e));t=await s.Ay.delete("/lead-assessment-templates/".concat(e))}return t.data}catch(t){throw console.error("Error deleting report template:",t),t}},initializeDefaultTemplates:async()=>{const e=[{templateType:"asbestosClearanceNonFriable",companyDetails:{name:"Lancaster & Dickenson Consulting Pty Ltd",address:"4/6 Dacre Street, Mitchell ACT 2911",email:"enquiries@landd.com.au",phone:"(02) 6241 2779",website:"www.landd.com.au",abn:"74 169 785 915"},reportHeaders:{title:"ASBESTOS REMOVAL CLEARANCE CERTIFICATE",subtitle:"Clearance Inspection Report"}},{templateType:"asbestosClearanceFriable",companyDetails:{name:"Lancaster & Dickenson Consulting Pty Ltd",address:"4/6 Dacre Street, Mitchell ACT 2911",email:"enquiries@landd.com.au",phone:"(02) 6241 2779",website:"www.landd.com.au",abn:"74 169 785 915"},reportHeaders:{title:"ASBESTOS REMOVAL CLEARANCE CERTIFICATE",subtitle:"Clearance Inspection Report"}},{templateType:"leadAssessment",companyDetails:{name:"Lancaster & Dickenson Consulting Pty Ltd",address:"4/6 Dacre Street, Mitchell ACT 2911",email:"enquiries@landd.com.au",phone:"(02) 6241 2779",website:"www.landd.com.au",abn:"74 169 785 915"},reportHeaders:{title:"LEAD ASSESSMENT REPORT",subtitle:"Lead Hazard Assessment"}}];try{for(const s of e)try{await n.getTemplateByType(s.templateType)}catch(a){var t;404===(null===(t=a.response)||void 0===t?void 0:t.status)&&(await n.createTemplate(s),console.log("Created default template for ".concat(s.templateType)))}}catch(a){throw console.error("Error initializing default templates:",a),a}}},r=n},37070:(e,t,a)=>{a.r(t),a.d(t,{default:()=>M});var s=a(89379),n=a(65043),r=a(26240),i=a(96446),l=a(15795),o=a(68903),c=a(12110),d=a(26494),m=a(85865),p=a(17392),A=a(43845),h=a(11906),x=a(63336),u=a(39336),b=a(67254),C=a(53193),S=a(79190),E=a(72221),g=a(32143),y=a(90035),T=a(26600),f=a(35316),j=a(29347),v=a(83560),w=a(91794),R=a(59662),I=a(70579);const N=(0,R.A)((0,I.jsx)("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3m3-10H5V5h10z"}),"Save");var P=a(47968);const D=(0,R.A)((0,I.jsx)("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.89-2-2-2m0 16H5V7h14zm-5.5-6c0 .83-.67 1.5-1.5 1.5s-1.5-.67-1.5-1.5.67-1.5 1.5-1.5 1.5.67 1.5 1.5M12 9c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5"}),"Preview");var L=a(63777),_=a(95187),F=a(88027),O=a(19882),k=a(43381);const M=()=>{(0,r.A)();const e=L.LU,{user:t}=(0,_.As)(),[a,R]=(0,n.useState)("asbestosClearanceNonFriable"),[M,U]=(0,n.useState)({}),[B,z]=(0,n.useState)(!0),[H,V]=(0,n.useState)(null),[W,J]=(0,n.useState)({}),[q,G]=(0,n.useState)(!1),[Z,$]=(0,n.useState)({show:!1,message:"",severity:"success"}),[Y,K]=(0,n.useState)({}),[Q,X]=(0,n.useState)(!1),[ee,te]=(0,n.useState)(!1),ae=e=>{if("asbestosClearanceNonFriable"===e||"asbestosClearanceFriable"===e){const t="asbestosClearanceFriable"===e;return{CLIENT_NAME:"Sample Client Pty Ltd",ASBESTOS_TYPE:t?"friable":"non-friable",SITE_NAME:"123 Sample Street, Canberra ACT",ASBESTOS_REMOVALIST:"Professional Asbestos Removal",LAA_NAME:"Patrick Cerone",LAA_LICENSE:"AA00031",INSPECTION_TIME:"09:00 AM",INSPECTION_DATE:"25 July 2024",REPORT_TYPE:t?"Friable":"Non-friable",PROJECT_NAME:"Sample Asbestos Removal Project",PROJECT_NUMBER:"PRJ-2024-001",SITE_ADDRESS:"123 Sample Street, Canberra ACT 2600",CLEARANCE_DATE:"25 July 2024",CLEARANCE_TIME:"09:00 AM"}}return"leadAssessment"===e?{SITE_NAME:"456 Lead Assessment Site, Canberra ACT",SITE_ADDRESS:"456 Lead Assessment Site, Canberra ACT 2600",BUILDING_DESCRIPTION:"Commercial office building with multiple floors",CONSTRUCTION_YEAR:"1985",NUMBER_OF_SAMPLES:"15",NUMBER_OF_ISSUES:"3",REPORT_DATE:"25 July 2024",ASSESSOR_NAME:"Patrick Cerone",ASSESSOR_LICENSE:"LA00031"}:{CLIENT_NAME:"Sample Client Pty Ltd",SITE_NAME:"123 Sample Street, Canberra ACT",SITE_ADDRESS:"123 Sample Street, Canberra ACT 2600"}},se=(ae(a),(e=>{if("asbestosClearanceNonFriable"===e||"asbestosClearanceFriable"===e){const t={"Background Information":["backgroundInformationTitle","backgroundInformationContent"],"Legislative Requirements":["legislativeRequirementsTitle","legislativeRequirementsContent"],"Inspection Details":["inspectionDetailsTitle","inspectionDetailsContent"],"Inspection Exclusions":["inspectionExclusionsTitle","inspectionExclusionsContent"],"Clearance Certification":["clearanceCertificationTitle","clearanceCertificationContent"],"Sign-off":["signOffContent"],Footer:["footerText"]};return"asbestosClearanceNonFriable"===e?t["Non-Friable Clearance Certificate Limitations"]=["nonFriableClearanceCertificateLimitationsTitle","nonFriableClearanceCertificateLimitationsContent"]:"asbestosClearanceFriable"===e&&(t["Friable Clearance Certificate Limitations"]=["friableClearanceCertificateLimitationsTitle","friableClearanceCertificateLimitationsContent"]),t}return"leadAssessment"===e?{"Executive Summary":["executiveSummaryTitle","executiveSummaryContent"],"Site Description":["siteDescriptionTitle","siteDescriptionContent"],"Assessment Methodology":["assessmentMethodologyTitle","assessmentMethodologyContent"],"Sampling Results":["samplingResultsTitle","samplingResultsContent"],"Risk Assessment":["riskAssessmentTitle","riskAssessmentContent"],Recommendations:["recommendationsTitle","recommendationsContent"],Conclusion:["conclusionTitle","conclusionContent"],Footer:["footerText"]}:{}})(a));(0,n.useEffect)((()=>{(async()=>{try{z(!0);const e=await O.A.getAllTemplates(),t={};e.forEach((e=>{t[e.templateType]=e})),U(t),K(ae(a))}catch(e){console.error("Error loading templates:",e),$({show:!0,message:"Error loading templates. Please refresh the page.",severity:"error"})}finally{z(!1)}})()}),[]);const ne=(e,t)=>{V(e),J(t),G(!0)},re=()=>{G(!1),V(null),J({})},ie=()=>{X(!Q)},le=e=>{if(!e)return"";let t=e;return Object.entries(Y).forEach((e=>{let[a,s]=e;t=t.replace(new RegExp("{".concat(a,"}"),"g"),s)})),t},oe=async()=>{try{const e=a,t=M[e].standardSections?"standardSections":"leadAssessmentSections";await O.A.updateTemplate(e,{[t]:{[H]:W}}),U((a=>{var n;return(0,s.A)((0,s.A)({},a),{},{[e]:(0,s.A)((0,s.A)({},a[e]),{},{[t]:(0,s.A)((0,s.A)({},null===(n=a[e])||void 0===n?void 0:n[t]),{},{[H]:W})})})})),$({show:!0,message:"".concat(H," updated successfully!"),severity:"success"}),V(null),J({}),setTimeout((()=>{$({show:!1,message:"",severity:"success"})}),3e3)}catch(e){console.error("Error saving template:",e),$({show:!0,message:"Error saving changes. Please try again.",severity:"error"})}},ce=async()=>{const e=M[a];if(e){te(!0);try{await(0,k.generateTemplatePDF)(e,Y,le);$({show:!0,message:"PDF preview generated successfully!",severity:"success"}),setTimeout((()=>{$({show:!1,message:"",severity:"success"})}),3e3)}catch(t){console.error("Error generating PDF:",t),$({show:!0,message:"Error generating PDF. Please try again.",severity:"error"})}finally{te(!1)}}},de=(t,s)=>{const n=M[a];return n?(0,I.jsx)(o.Ay,{item:!0,xs:12,children:(0,I.jsx)(c.A,{children:(0,I.jsxs)(d.A,{children:[(0,I.jsx)(i.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:(0,I.jsx)(m.A,{variant:"h6",color:"black",children:t})}),(0,I.jsx)(o.Ay,{container:!0,spacing:2,children:s.map((t=>(0,I.jsx)(o.Ay,{item:!0,xs:12,children:(0,I.jsxs)(i.A,{sx:{p:2,border:"1px solid ".concat(e.grey[700]),borderRadius:1,position:"relative"},children:[(0,I.jsxs)(i.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1},children:[(0,I.jsx)(m.A,{variant:"subtitle2",color:"black",children:t.charAt(0).toUpperCase()+t.slice(1).replace(/([A-Z])/g," $1")}),(0,I.jsx)(p.A,{onClick:()=>((e,t)=>{V(e),J(t)})(t,n.standardSections[t]||""),size:"small",children:(0,I.jsx)(v.A,{})})]}),(0,I.jsx)(m.A,{variant:"body2",color:"black",sx:{whiteSpace:"pre-line"},children:n.standardSections[t]||""})]})},t)))})]})})},t):null};return(0,I.jsx)(F.A,{requiredPermissions:["admin.view"],children:(0,I.jsxs)(i.A,{m:"20px",children:[(0,I.jsxs)(i.A,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[(0,I.jsx)(m.A,{variant:"h2",color:"black",fontWeight:"bold",sx:{mb:"5px"},children:"Report Templates"}),(0,I.jsx)(i.A,{sx:{display:"flex",gap:2},children:(0,I.jsx)(h.A,{onClick:ie,startIcon:(0,I.jsx)(D,{}),variant:"outlined",children:Q?"Hide Preview":"Show Preview"})})]}),(0,I.jsx)(m.A,{variant:"h5",color:"black",children:"Manage standardized content for different report types"}),Z.show&&(0,I.jsx)(b.A,{severity:Z.severity,sx:{mt:2,mb:2},children:Z.message}),(0,I.jsx)(i.A,{sx:{mt:3},children:B?(0,I.jsx)(i.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"200px"},children:(0,I.jsx)(m.A,{variant:"h6",color:"black",children:"Loading templates..."})}):(0,I.jsx)(o.Ay,{container:!0,spacing:3,children:(()=>{const e=Object.values(M)[0];if(null===e||void 0===e||!e.companyDetails)return null;const t=e.companyDetails,a=Object.entries(t),s=a.slice(0,3),n=a.slice(3);return(0,I.jsx)(o.Ay,{item:!0,xs:12,children:(0,I.jsx)(c.A,{children:(0,I.jsxs)(d.A,{children:[(0,I.jsxs)(i.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[(0,I.jsx)(m.A,{variant:"h6",color:"black",children:"Company Details"}),(0,I.jsx)(p.A,{onClick:()=>ne("companyDetails",t),size:"small",children:(0,I.jsx)(v.A,{})})]}),(0,I.jsxs)(o.Ay,{container:!0,spacing:3,children:[(0,I.jsx)(o.Ay,{item:!0,xs:12,md:6,children:(0,I.jsx)(i.A,{sx:{display:"flex",flexDirection:"column",gap:1},children:s.map((e=>{let[t,a]=e;return(0,I.jsxs)(i.A,{sx:{display:"flex",justifyContent:"space-between"},children:[(0,I.jsxs)(m.A,{variant:"body2",color:"black",children:[t.charAt(0).toUpperCase()+t.slice(1).replace(/([A-Z])/g," $1"),":"]}),(0,I.jsx)(m.A,{variant:"body2",color:"black",children:a})]},t)}))})}),(0,I.jsx)(o.Ay,{item:!0,xs:12,md:6,children:(0,I.jsx)(i.A,{sx:{display:"flex",flexDirection:"column",gap:1},children:n.map((e=>{let[t,a]=e;return(0,I.jsxs)(i.A,{sx:{display:"flex",justifyContent:"space-between"},children:[(0,I.jsxs)(m.A,{variant:"body2",color:"black",children:[t.charAt(0).toUpperCase()+t.slice(1).replace(/([A-Z])/g," $1"),":"]}),(0,I.jsx)(m.A,{variant:"body2",color:"black",children:a})]},t)}))})})]})]})})})})()})}),(0,I.jsx)(i.A,{sx:{mt:3},children:!B&&(0,I.jsx)(o.Ay,{container:!0,spacing:3,children:(()=>{const e=["CLIENT_NAME","SITE_NAME","SITE_ADDRESS"],t=["ASBESTOS_TYPE","ASBESTOS_REMOVALIST","LAA_NAME","LAA_LICENSE","INSPECTION_TIME","INSPECTION_DATE","REPORT_TYPE","PROJECT_NAME","PROJECT_NUMBER","CLEARANCE_DATE","CLEARANCE_TIME","SIGNATURE_IMAGE"],s=["BUILDING_DESCRIPTION","CONSTRUCTION_YEAR","NUMBER_OF_SAMPLES","NUMBER_OF_ISSUES","REPORT_DATE","ASSESSOR_NAME","ASSESSOR_LICENSE"];let n=e;return"asbestosClearanceNonFriable"===a||"asbestosClearanceFriable"===a?n=[...e,...t]:"leadAssessment"===a&&(n=[...e,...s]),(0,I.jsx)(o.Ay,{item:!0,xs:12,children:(0,I.jsx)(c.A,{children:(0,I.jsxs)(d.A,{children:[(0,I.jsx)(m.A,{variant:"h6",color:"black",sx:{mb:2},children:"Available Placeholders"}),(0,I.jsx)(m.A,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Use these placeholders in your template content. They will be automatically replaced with actual data when generating reports."}),(0,I.jsx)(i.A,{sx:{display:"flex",flexWrap:"wrap",gap:1},children:n.map((e=>(0,I.jsx)(A.A,{label:"{".concat(e,"}"),size:"small",variant:"outlined",sx:{fontSize:"0.8rem"}},e)))})]})})})})()})}),(0,I.jsx)(i.A,{sx:{mt:3,mb:2},children:(0,I.jsxs)(C.A,{fullWidth:!0,children:[(0,I.jsx)(S.A,{id:"template-select-label",children:"Select Report Template"}),(0,I.jsx)(E.A,{labelId:"template-select-label",value:a,label:"Select Report Template",onChange:e=>{const t=e.target.value;R(t),K(ae(t))},sx:{"& .MuiSelect-select":{color:"black"}},children:[{id:"asbestosClearanceNonFriable",name:"Non-Friable Asbestos Clearance Report",color:"#FF6B6B"},{id:"asbestosClearanceFriable",name:"Friable Asbestos Clearance Report",color:"#FF6B6B"},{id:"asbestosAssessment",name:"Asbestos Assessment Report",color:"#FF6B6B"},{id:"leadAssessment",name:"Lead Assessment Report",color:"#4ECDC4"},{id:"mouldAssessment",name:"Mould Assessment Report",color:"#45B7D1"},{id:"airMonitoringReport",name:"Air Monitoring Report",color:"#6C5CE7"},{id:"fibreIdentificationReport",name:"Fibre Identification Report",color:"#00B894"},{id:"inspectionReport",name:"Inspection Report",color:"#E17055"},{id:"complianceReport",name:"Compliance Report",color:"#74B9FF"},{id:"riskAssessmentReport",name:"Risk Assessment Report",color:"#A29BFE"},{id:"managementPlanReport",name:"Management Plan Report",color:"#FD79A8"}].map((e=>(0,I.jsx)(g.A,{value:e.id,children:e.name},e.id)))})]})}),(0,I.jsx)(i.A,{sx:{mt:3},children:B?(0,I.jsx)(i.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"200px"},children:(0,I.jsx)(m.A,{variant:"h6",color:"black",children:"Loading templates..."})}):(0,I.jsxs)(o.Ay,{container:!0,spacing:3,children:[Q&&(()=>{const e=M[a];return e&&Q?(0,I.jsx)(o.Ay,{item:!0,xs:12,children:(0,I.jsx)(c.A,{children:(0,I.jsxs)(d.A,{children:[(0,I.jsxs)(i.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[(0,I.jsx)(m.A,{variant:"h6",color:"black",children:"Live Preview"}),(0,I.jsxs)(i.A,{sx:{display:"flex",gap:1},children:[(0,I.jsx)(h.A,{onClick:ce,startIcon:(0,I.jsx)(P.A,{}),variant:"contained",size:"small",disabled:ee,sx:{backgroundColor:"#2e7d32","&:hover":{backgroundColor:"#1b5e20"}},children:ee?"Generating...":"Generate PDF"}),(0,I.jsx)(h.A,{onClick:ie,startIcon:(0,I.jsx)(D,{}),variant:"outlined",size:"small",children:"Hide Preview"})]})]}),(0,I.jsxs)(x.A,{sx:{p:3,backgroundColor:"white",color:"black",maxHeight:"600px",overflow:"auto",fontFamily:"Arial, sans-serif"},children:[(0,I.jsx)(m.A,{variant:"h4",sx:{mb:2,color:"#009900"},children:le(e.standardSections.backgroundInformationTitle)}),(0,I.jsx)(m.A,{variant:"body1",sx:{mb:3,whiteSpace:"pre-line"},children:le(e.standardSections.backgroundInformationContent)}),(0,I.jsx)(u.A,{sx:{my:2}}),(0,I.jsx)(m.A,{variant:"h5",sx:{mb:2},children:le(e.standardSections.legislativeRequirementsTitle)}),(0,I.jsx)(m.A,{variant:"body1",sx:{mb:2,whiteSpace:"pre-line"},children:le(e.standardSections.legislativeRequirementsContent)}),(0,I.jsx)(u.A,{sx:{my:2}}),(0,I.jsx)(m.A,{variant:"h5",sx:{mb:2},children:le(e.standardSections.nonFriableClearanceCertificateLimitationsTitle)}),(0,I.jsx)(m.A,{variant:"body1",sx:{mb:2,whiteSpace:"pre-line"},children:le(e.standardSections.nonFriableClearanceCertificateLimitationsContent)}),(0,I.jsx)(u.A,{sx:{my:2}}),(0,I.jsx)(m.A,{variant:"h5",sx:{mb:2},children:le(e.standardSections.inspectionDetailsTitle)}),(0,I.jsx)(m.A,{variant:"body1",sx:{mb:2,whiteSpace:"pre-line"},children:le(e.standardSections.inspectionDetailsContent)}),(0,I.jsx)(u.A,{sx:{my:2}}),(0,I.jsx)(m.A,{variant:"h5",sx:{mb:2},children:le(e.standardSections.inspectionExclusionsTitle)}),(0,I.jsx)(m.A,{variant:"body1",sx:{mb:2,whiteSpace:"pre-line"},children:le(e.standardSections.inspectionExclusionsContent)}),(0,I.jsx)(u.A,{sx:{my:2}}),(0,I.jsx)(m.A,{variant:"h5",sx:{mb:2},children:le(e.standardSections.clearanceCertificationTitle)}),(0,I.jsx)(m.A,{variant:"body1",sx:{mb:2,whiteSpace:"pre-line"},children:le(e.standardSections.clearanceCertificationContent)}),(0,I.jsx)(u.A,{sx:{my:2}}),(0,I.jsx)(m.A,{variant:"body1",sx:{mb:2,whiteSpace:"pre-line"},children:le(e.standardSections.signOffContent)})]})]})})}):null})(),Object.entries(se).map((e=>{let[t,a]=e;return de(t,a)}))]})}),(0,I.jsxs)(y.A,{open:q,onClose:re,maxWidth:"md",fullWidth:!0,children:[(0,I.jsxs)(T.A,{children:["Edit"," ",(null===H||void 0===H?void 0:H.charAt(0).toUpperCase())+(null===H||void 0===H?void 0:H.slice(1).replace(/([A-Z])/g," $1"))]}),(0,I.jsx)(f.A,{children:(0,I.jsx)(i.A,{sx:{mt:2},children:(()=>{if(!H||!W)return null;const e=M[a][H];return"companyDetails"===H?(0,I.jsx)(i.A,{sx:{display:"flex",flexDirection:"column",gap:2},children:Object.keys(e).map((e=>(0,I.jsx)(l.A,{label:e.charAt(0).toUpperCase()+e.slice(1).replace(/([A-Z])/g," $1"),value:W[e]||"",onChange:t=>J((a=>(0,s.A)((0,s.A)({},a),{},{[e]:t.target.value}))),fullWidth:!0,variant:"outlined"},e)))}):"standardSections"===H?(0,I.jsx)(i.A,{sx:{display:"flex",flexDirection:"column",gap:2},children:Object.keys(e).map((e=>(0,I.jsx)(l.A,{label:e.charAt(0).toUpperCase()+e.slice(1).replace(/([A-Z])/g," $1"),value:W[e]||"",onChange:t=>J((a=>(0,s.A)((0,s.A)({},a),{},{[e]:t.target.value}))),fullWidth:!0,multiline:!0,rows:4,variant:"outlined"},e)))}):"reportHeaders"===H?(0,I.jsx)(i.A,{sx:{display:"flex",flexDirection:"column",gap:2},children:Object.keys(e).map((e=>(0,I.jsx)(l.A,{label:e.charAt(0).toUpperCase()+e.slice(1).replace(/([A-Z])/g," $1"),value:W[e]||"",onChange:t=>J((a=>(0,s.A)((0,s.A)({},a),{},{[e]:t.target.value}))),fullWidth:!0,variant:"outlined"},e)))}):null})()})}),(0,I.jsxs)(j.A,{children:[(0,I.jsx)(h.A,{onClick:re,startIcon:(0,I.jsx)(w.A,{}),children:"Cancel"}),(0,I.jsx)(h.A,{onClick:async()=>{try{const e=a;await O.A.updateTemplate(e,{[H]:W}),U((t=>(0,s.A)((0,s.A)({},t),{},{[e]:(0,s.A)((0,s.A)({},t[e]),{},{[H]:W})}))),$({show:!0,message:"".concat(H," updated successfully!"),severity:"success"}),G(!1),V(null),J({}),setTimeout((()=>{$({show:!1,message:"",severity:"success"})}),3e3)}catch(e){console.error("Error saving template:",e),$({show:!0,message:"Error saving changes. Please try again.",severity:"error"})}},variant:"contained",startIcon:(0,I.jsx)(N,{}),children:"Save Changes"})]})]}),H&&(0,I.jsx)(i.A,{sx:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.8)",zIndex:1300,display:"flex",alignItems:"center",justifyContent:"center",p:2},children:(0,I.jsxs)(x.A,{sx:{p:3,maxWidth:"800px",width:"100%",maxHeight:"80vh",overflow:"auto"},children:[(0,I.jsxs)(m.A,{variant:"h6",sx:{mb:2},children:["Edit"," ",H.charAt(0).toUpperCase()+H.slice(1).replace(/([A-Z])/g," $1")]}),(()=>{if(!H||!W)return null;return(0,I.jsxs)(i.A,{sx:{display:"flex",flexDirection:"column",gap:2},children:[(0,I.jsx)(l.A,{label:H.charAt(0).toUpperCase()+H.slice(1).replace(/([A-Z])/g," $1"),value:W,onChange:e=>J(e.target.value),fullWidth:!0,multiline:!0,rows:8,variant:"outlined",helperText:"Use {PLACEHOLDER_NAME} for dynamic content. Available placeholders will be replaced with actual data when generating reports."}),(0,I.jsxs)(i.A,{sx:{p:2,backgroundColor:"#f5f5f5",borderRadius:1},children:[(0,I.jsx)(m.A,{variant:"subtitle2",color:"text.secondary",sx:{mb:1},children:"Available Placeholders:"}),(0,I.jsx)(i.A,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:["CLIENT_NAME","ASBESTOS_TYPE","SITE_NAME","ASBESTOS_REMOVALIST","LAA_NAME","LAA_LICENSE","INSPECTION_TIME","INSPECTION_DATE","REPORT_TYPE","PROJECT_NAME","PROJECT_NUMBER","SITE_ADDRESS","REMOVAL_CONTRACTOR","REMOVAL_LICENSE","INSPECTOR_NAME","INSPECTOR_LICENSE","INSPECTION_DATETIME","CLEARANCE_DATE","CLEARANCE_TIME","SIGNATURE_IMAGE"].map((e=>(0,I.jsx)(A.A,{label:"{".concat(e,"}"),size:"small",variant:"outlined",sx:{fontSize:"0.7rem",cursor:"pointer"},onClick:()=>{const t=document.querySelector('textarea[aria-label*="'+H.charAt(0).toUpperCase()+H.slice(1).replace(/([A-Z])/g," $1")+'"]');if(t){const a=t.selectionStart,s=t.selectionEnd,n=W.substring(0,a)+"{".concat(e,"}")+W.substring(s);J(n),setTimeout((()=>t.focus()),0)}}},e)))})]}),(0,I.jsxs)(i.A,{sx:{display:"flex",gap:1,justifyContent:"flex-end"},children:[(0,I.jsx)(h.A,{onClick:re,startIcon:(0,I.jsx)(w.A,{}),children:"Cancel"}),(0,I.jsx)(h.A,{onClick:oe,variant:"contained",startIcon:(0,I.jsx)(N,{}),children:"Save"})]})]})})()]})})]})})}},43381:(e,t,a)=>{a.r(t),a.d(t,{generateHTMLPDF:()=>r,generateHTMLTemplatePDF:()=>i,generateTemplatePDF:()=>n});var s=a(37762);a(65239);const n=async(e,t,a)=>{const n=new s.default,r=n.internal.pageSize.getWidth(),i=n.internal.pageSize.getHeight(),l=20,o=r-40;let c=l;const d=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:11,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"normal",s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8;if(!e)return c;n.setFontSize(t),n.setFont("helvetica",a);const r=n.splitTextToSize(e,o);return n.text(e,l,c,{maxWidth:o}),c+=r.length*t*1.2+s,c},m=function(e){return d(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:14,arguments.length>2&&void 0!==arguments[2]?arguments[2]:"bold",12)};c=m(a(e.standardSections.frontCoverTitle||"Non-friable Asbestos Removal Clearance"),16,"bold"),c=d(a(e.standardSections.frontCoverSubtitle||""),12,"normal",20),c+=10,e.companyDetails&&(c=m("Company Details",12,"bold"),Object.entries(e.companyDetails).forEach((e=>{let[t,a]=e;const s=t.charAt(0).toUpperCase()+t.slice(1).replace(/([A-Z])/g," $1");c=d("".concat(s,": ").concat(a),10,"normal",4)})),c+=10),c=m(a(e.standardSections.inspectionDetailsTitle||"Inspection Details"),12,"bold"),c=d(a(e.standardSections.inspectionIntroduction||""),10,"normal",8),c=d(a(e.standardSections.inspectionSpecifics||""),10,"normal",8),c=d(a(e.standardSections.tableIntroduction||""),10,"normal",8),c=d("Sample Inspection Results:",10,"bold",4);[["Area","Material Type","Condition","Result"],["Kitchen","Vinyl Floor Tiles","Good","Pass"],["Bathroom","Vinyl Floor Tiles","Good","Pass"],["Living Room","Vinyl Floor Tiles","Good","Pass"]].forEach(((e,t)=>{const a=0===t,s=a?"bold":"normal",r=a?10:9,i=[40,50,40,30];let o=l;e.forEach(((e,t)=>{n.setFontSize(r),n.setFont("helvetica",s),n.text(e,o,c,{maxWidth:i[t]}),o+=i[t]+5})),c+=1.2*r+2})),c+=10,c>i-100&&(n.addPage(),c=l),c=m(a(e.standardSections.clearanceCertificationTitle||"Clearance Certification"),12,"bold"),c=d(a(e.standardSections.clearanceCertificationText||""),10,"normal",8),c=d(a(e.standardSections.riskAssessmentText||""),10,"normal",8),c=d(a(e.standardSections.contactText||""),10,"normal",8),c=d(a(e.standardSections.behalfText||""),10,"normal",8),c=d(a(e.standardSections.signatureTitle||""),10,"bold",8),c>i-100&&(n.addPage(),c=l),c=m(a(e.standardSections.backgroundTitle||"Background Information"),12,"bold"),c=d(a(e.standardSections.backgroundIntroduction||""),10,"normal",8),c=d("\u2022 ".concat(a(e.standardSections.bulletPoint1||"")),10,"normal",4),c=d("\u2022 ".concat(a(e.standardSections.bulletPoint2||"")),10,"normal",4),c=d(a(e.standardSections.requirementsText||""),10,"normal",8),c=d("\u2022 ".concat(a(e.standardSections.bulletPoint3||"")),10,"normal",4),c=d("\u2022 ".concat(a(e.standardSections.bulletPoint4||"")),10,"normal",4),c=d("\u2022 ".concat(a(e.standardSections.bulletPoint5||"")),10,"normal",4),c>i-100&&(n.addPage(),c=l),c=m(a(e.standardSections.legislativeTitle||"Legislative Requirements"),12,"bold"),c=d(a(e.standardSections.legislativeIntroduction||""),10,"normal",8),c=d("\u2022 ".concat(a(e.standardSections.legislativePoint1||"")),10,"normal",4),c=d("\u2022 ".concat(a(e.standardSections.legislativePoint2||"")),10,"normal",4),c=d("\u2022 ".concat(a(e.standardSections.legislativePoint3||"")),10,"normal",4),c=m(a(e.standardSections.limitationsTitle||"Limitations"),12,"bold"),c=d(a(e.standardSections.limitationsText||""),10,"normal",8),c>i-150&&(n.addPage(),c=l),c=m("Authorised Signature",12,"bold"),c+=20,n.setLineWidth(.5),n.line(l,c,100,c),c+=5,c=d("Name: John Smith",10,"normal",4),c=d("License: AI000456",10,"normal",4),c=d("Date: 25 July 2024",10,"normal",4),c+=20,c=d(a(e.standardSections.footerText||""),9,"normal",8);const p="asbestos-clearance-template-preview-".concat((new Date).toISOString().split("T")[0],".pdf");return n.save(p),p},r=async(e,t)=>i(e,t),i=async(e,t)=>{try{var a;console.log("Starting server-side PDF generation with data:",t);const e="".concat("https://landd-app-backend1.onrender.com/api","/pdf/generate-asbestos-clearance?t=").concat(Date.now());console.log("Calling backend URL:",e);const s=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token")),"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:"0"},body:JSON.stringify({clearanceData:t})});if(console.log("Response status:",s.status),console.log("Response headers:",Object.fromEntries(s.headers.entries())),!s.ok){const e=await s.json();throw new Error(e.error||"Failed to generate PDF")}const n=await s.blob();console.log("PDF blob size:",n.size,"bytes");const r=window.URL.createObjectURL(n),i=document.createElement("a");i.href=r;const l="asbestos-clearance-".concat((null===(a=t.projectId)||void 0===a?void 0:a.name)||"report","-").concat((new Date).toISOString().split("T")[0],".pdf");return i.download=l,document.body.appendChild(i),i.click(),document.body.removeChild(i),window.URL.revokeObjectURL(r),console.log("PDF generation completed successfully:",l),l}catch(s){throw console.error("Error generating HTML template PDF:",s),console.error("Error stack:",s.stack),s}}},47968:(e,t,a)=>{a.d(t,{A:()=>r});var s=a(59662),n=a(70579);const r=(0,s.A)((0,n.jsx)("path",{d:"M5 20h14v-2H5zM19 9h-4V3H9v6H5l7 7z"}),"Download")}}]);
//# sourceMappingURL=70.a362eabf.chunk.js.map