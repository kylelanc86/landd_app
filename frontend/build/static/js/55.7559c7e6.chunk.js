"use strict";(self.webpackChunkair_monitoring_frontend=self.webpackChunkair_monitoring_frontend||[]).push([[55],{32058:(e,t,a)=>{a.d(t,{A:()=>r});var s=a(82431);const n="/asbestos-clearance-reports",r={getAll:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(await s.A.get(n,{params:e})).data},getByClearanceId:async e=>(await s.A.get("".concat(n,"/clearance/").concat(e))).data,getById:async e=>(await s.A.get("".concat(n,"/").concat(e))).data,create:async e=>(await s.A.post(n,e)).data,update:async(e,t)=>(await s.A.put("".concat(n,"/").concat(e),t)).data,delete:async e=>(await s.A.delete("".concat(n,"/").concat(e))).data}},45360:(e,t,a)=>{a.d(t,{A:()=>i});var s=a(89379),n=a(82431);const r="/asbestos-clearances",i={getAll:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(await n.A.get(r,{params:e})).data},getById:async e=>(await n.A.get("".concat(r,"/").concat(e))).data,create:async e=>(await n.A.post(r,e)).data,update:async(e,t)=>(await n.A.put("".concat(r,"/").concat(e),t)).data,delete:async e=>(await n.A.delete("".concat(r,"/").concat(e))).data,updateStatus:async(e,t)=>(await n.A.patch("".concat(r,"/").concat(e,"/status"),{status:t})).data,getStats:async()=>(await n.A.get("".concat(r,"/stats/overview"))).data,search:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const a=(0,s.A)({search:e},t);return(await n.A.get(r,{params:a})).data},getByStatus:async e=>(await n.A.get(r,{params:{status:e}})).data,getByRemovalist:async e=>(await n.A.get(r,{params:{asbestosRemovalist:e}})).data}},72429:(e,t,a)=>{a.d(t,{A:()=>r});var s=a(59662),n=a(70579);const r=(0,s.A)([(0,n.jsx)("circle",{cx:"12",cy:"12",r:"3.2"},"0"),(0,n.jsx)("path",{d:"M9 2 7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2zm3 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5"},"1")],"PhotoCamera")},95055:(e,t,a)=>{a.r(t),a.d(t,{default:()=>Y});var s=a(89379),n=a(65043),r=a(96446),i=a(81637),l=a(67254),o=a(17392),c=a(85865),d=a(11906),h=a(12110),A=a(26494),p=a(79650),u=a(63336),x=a(71806),j=a(84882),m=a(28076),y=a(10039),g=a(73460),v=a(43845),b=a(90035),f=a(26600),w=a(35316),C=a(68903),D=a(15795),I=a(53193),k=a(79190),S=a(72221),T=a(32143),z=a(29347),P=a(73158),B=a(87332),W=a(70141),E=a(83560),U=a(51387),_=a(72429),F=a(59662),L=a(70579);const N=(0,F.A)((0,L.jsx)("path",{d:"M5 20h14v-2H5zm0-10h4v6h6v-6h4l-7-7z"}),"Upload");var R=a(73216),q=a(63777),M=a(88027),H=a(32058),V=a(45360);const Y=()=>{var e;const t=q.LU,a=(0,R.Zp)(),{clearanceId:F}=(0,R.g)(),[Y,Z]=(0,n.useState)([]),[G,J]=(0,n.useState)(null),[K,O]=(0,n.useState)(!0),[Q,X]=(0,n.useState)(null),[$,ee]=(0,n.useState)(!1),[te,ae]=(0,n.useState)(null),[se,ne]=(0,n.useState)({open:!1,message:"",severity:"success"}),[re,ie]=(0,n.useState)({locationDescription:"",materialDescription:"",asbestosType:"non-friable",photograph:"",notes:""}),[le,oe]=(0,n.useState)(null),[ce,de]=(0,n.useState)(null);(0,n.useEffect)((()=>{he()}),[F]);const he=async()=>{try{O(!0);const[e,t]=await Promise.all([H.A.getByClearanceId(F),V.A.getById(F)]);console.log("Clearance items API response:",e),console.log("Clearance API response:",t),Z(e||[]),J(t)}catch(e){console.error("Error fetching data:",e),X("Failed to load data")}finally{O(!1)}},Ae=()=>{ie({locationDescription:"",materialDescription:"",asbestosType:"non-friable",photograph:"",notes:""}),oe(null),de(null)},pe=e=>{switch(e){case"friable":return"error";case"non-friable":return"warning";default:return"default"}},ue=e=>{const t=e.target.files[0];if(t){de(t);const e=new FileReader;e.onload=e=>{oe(e.target.result),ie((0,s.A)((0,s.A)({},re),{},{photograph:e.target.result}))},e.readAsDataURL(t)}};return K?(0,L.jsx)(r.A,{display:"flex",justifyContent:"center",alignItems:"center",height:"400px",children:(0,L.jsx)(i.A,{})}):Q?(0,L.jsx)(r.A,{m:"20px",children:(0,L.jsx)(l.A,{severity:"error",children:Q})}):(0,L.jsx)(M.A,{requiredPermissions:["asbestos.view"],children:(0,L.jsxs)(r.A,{m:"20px",children:[(0,L.jsxs)(r.A,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[(0,L.jsxs)(r.A,{display:"flex",alignItems:"center",gap:2,children:[(0,L.jsx)(o.A,{onClick:()=>a("/clearances/asbestos"),color:"primary",children:(0,L.jsx)(B.A,{})}),(0,L.jsxs)(r.A,{children:[(0,L.jsx)(c.A,{variant:"h2",color:t.grey[100],fontWeight:"bold",sx:{mb:"5px"},children:"Clearance Items"}),G&&(0,L.jsxs)(c.A,{variant:"h6",color:t.secondary[500],children:[(null===(e=G.projectId)||void 0===e?void 0:e.name)||"Unknown Project"," -"," ",G.clearanceDate?new Date(G.clearanceDate).toLocaleDateString():"Unknown Date"]})]})]}),(0,L.jsx)(d.A,{variant:"contained",color:"secondary",onClick:()=>{ae(null),Ae(),ee(!0)},startIcon:(0,L.jsx)(W.A,{}),children:"Add Item"})]}),(0,L.jsx)(h.A,{sx:{mt:3},children:(0,L.jsx)(A.A,{children:(0,L.jsx)(p.A,{component:u.A,children:(0,L.jsxs)(x.A,{children:[(0,L.jsx)(j.A,{children:(0,L.jsxs)(m.A,{children:[(0,L.jsx)(y.A,{children:"Location"}),(0,L.jsx)(y.A,{children:"Material Description"}),(0,L.jsx)(y.A,{children:"Asbestos Type"}),(0,L.jsx)(y.A,{children:"Photograph"}),(0,L.jsx)(y.A,{children:"Notes"}),(0,L.jsx)(y.A,{children:"Actions"})]})}),(0,L.jsx)(g.A,{children:(Y||[]).map((e=>(0,L.jsxs)(m.A,{children:[(0,L.jsx)(y.A,{children:e.locationDescription}),(0,L.jsx)(y.A,{children:e.materialDescription}),(0,L.jsx)(y.A,{children:(0,L.jsx)(v.A,{label:e.asbestosType,color:pe(e.asbestosType),size:"small"})}),(0,L.jsx)(y.A,{children:e.photograph?(0,L.jsx)(v.A,{label:"Yes",color:"success",size:"small"}):(0,L.jsx)(v.A,{label:"No",color:"default",size:"small"})}),(0,L.jsx)(y.A,{children:e.notes?(0,L.jsx)(c.A,{variant:"body2",noWrap:!0,children:e.notes}):(0,L.jsx)(c.A,{variant:"body2",color:"text.secondary",children:"No notes"})}),(0,L.jsxs)(y.A,{children:[(0,L.jsx)(o.A,{onClick:()=>(e=>{ae(e),ie({locationDescription:e.locationDescription,materialDescription:e.materialDescription,asbestosType:e.asbestosType,photograph:e.photograph||"",notes:e.notes||""}),oe(e.photograph||null),de(null),ee(!0)})(e),color:"primary",size:"small",title:"Edit",children:(0,L.jsx)(E.A,{})}),(0,L.jsx)(o.A,{onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this item?"))try{await H.A.delete(e._id),ne({open:!0,message:"Item deleted successfully",severity:"success"}),he()}catch(t){console.error("Error deleting item:",t),ne({open:!0,message:"Failed to delete item",severity:"error"})}})(e),color:"error",size:"small",title:"Delete",children:(0,L.jsx)(U.A,{})})]})]},e._id)))})]})})})}),(0,L.jsxs)(b.A,{open:$,onClose:()=>ee(!1),maxWidth:"md",fullWidth:!0,children:[(0,L.jsx)(f.A,{children:te?"Edit Item":"Add New Item"}),(0,L.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{const e=(0,s.A)((0,s.A)({},re),{},{clearanceId:F});te?(await H.A.update(te._id,e),ne({open:!0,message:"Item updated successfully",severity:"success"})):(await H.A.create(e),ne({open:!0,message:"Item created successfully",severity:"success"})),ee(!1),ae(null),Ae(),he()}catch(t){console.error("Error saving item:",t),ne({open:!0,message:"Failed to save item",severity:"error"})}},children:[(0,L.jsx)(w.A,{children:(0,L.jsxs)(C.Ay,{container:!0,spacing:2,children:[(0,L.jsx)(C.Ay,{item:!0,xs:12,children:(0,L.jsx)(D.A,{fullWidth:!0,label:"Location Description",value:re.locationDescription,onChange:e=>ie((0,s.A)((0,s.A)({},re),{},{locationDescription:e.target.value})),required:!0})}),(0,L.jsx)(C.Ay,{item:!0,xs:12,children:(0,L.jsx)(D.A,{fullWidth:!0,label:"Material Description",value:re.materialDescription,onChange:e=>ie((0,s.A)((0,s.A)({},re),{},{materialDescription:e.target.value})),required:!0})}),(0,L.jsx)(C.Ay,{item:!0,xs:12,md:6,children:(0,L.jsxs)(I.A,{fullWidth:!0,required:!0,children:[(0,L.jsx)(k.A,{children:"Asbestos Type"}),(0,L.jsxs)(S.A,{value:re.asbestosType,onChange:e=>ie((0,s.A)((0,s.A)({},re),{},{asbestosType:e.target.value})),label:"Asbestos Type",children:[(0,L.jsx)(T.A,{value:"non-friable",children:"Non-friable"}),(0,L.jsx)(T.A,{value:"friable",children:"Friable"})]})]})}),(0,L.jsx)(C.Ay,{item:!0,xs:12,md:6,children:(0,L.jsxs)(r.A,{children:[(0,L.jsx)(c.A,{variant:"subtitle2",gutterBottom:!0,children:"Photograph"}),(0,L.jsxs)(r.A,{sx:{display:"flex",gap:1,mb:2},children:[(0,L.jsx)(d.A,{variant:"outlined",startIcon:(0,L.jsx)(_.A,{}),onClick:()=>{const e=document.createElement("input");e.type="file",e.accept="image/*",e.capture="environment",e.onchange=ue,e.click()},size:"small",children:"Take Photo"}),(0,L.jsxs)(d.A,{variant:"outlined",startIcon:(0,L.jsx)(N,{}),component:"label",size:"small",children:["Upload Photo",(0,L.jsx)("input",{type:"file",hidden:!0,accept:"image/*",onChange:ue})]}),le&&(0,L.jsx)(d.A,{variant:"outlined",color:"error",startIcon:(0,L.jsx)(U.A,{}),onClick:()=>{de(null),oe(null),ie((0,s.A)((0,s.A)({},re),{},{photograph:""}))},size:"small",children:"Remove"})]}),le&&(0,L.jsx)(r.A,{sx:{width:200,height:150,borderRadius:1,overflow:"hidden",border:"1px solid #ddd",mb:2},children:(0,L.jsx)("img",{src:le,alt:"Preview",style:{width:"100%",height:"100%",objectFit:"cover"}})})]})}),(0,L.jsx)(C.Ay,{item:!0,xs:12,children:(0,L.jsx)(D.A,{fullWidth:!0,label:"Notes",value:re.notes,onChange:e=>ie((0,s.A)((0,s.A)({},re),{},{notes:e.target.value})),multiline:!0,rows:3})})]})}),(0,L.jsxs)(z.A,{children:[(0,L.jsx)(d.A,{onClick:()=>ee(!1),children:"Cancel"}),(0,L.jsx)(d.A,{type:"submit",variant:"contained",children:te?"Update":"Create"})]})]})]}),(0,L.jsx)(P.A,{open:se.open,autoHideDuration:6e3,onClose:()=>ne((0,s.A)((0,s.A)({},se),{},{open:!1})),children:(0,L.jsx)(l.A,{onClose:()=>ne((0,s.A)((0,s.A)({},se),{},{open:!1})),severity:se.severity,children:se.message})})]})})}}}]);
//# sourceMappingURL=55.7559c7e6.chunk.js.map